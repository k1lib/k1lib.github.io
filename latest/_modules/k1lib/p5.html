<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>k1lib.p5 &mdash; k1lib  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> k1lib
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../base.html">Base module</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cli/index.html">k1lib.cli module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../callbacks/index.html">k1lib.callbacks module</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../k1a.html">k1lib._k1a module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../k1ui.html">k1lib.k1ui module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../eqn.html">k1lib.eqn module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fmt.html">k1lib.fmt module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../graphEqn.html">k1lib.graphEqn module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../imports.html">k1lib.imports module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mo.html">k1lib.mo module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knn.html">k1lib.knn module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../p5.html">k1lib.p5 module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../schedule.html">k1lib.schedule module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../selector.html">k1lib.selector module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../selen.html">k1lib.selen module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../serve.html">k1lib.serve module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../viz.html">k1lib.viz module</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../monkey.html">Monkey patched classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelogs.html">Changelogs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">k1lib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">k1lib.p5</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for k1lib.p5</h1><div class="highlight"><pre>
<span></span><span class="c1"># AUTOGENERATED FILE! PLEASE DON&#39;T EDIT HERE. EDIT THE SOURCE NOTEBOOKS INSTEAD</span>
<span class="sd">&quot;&quot;&quot;A quick and dirty tiny module emulating the `p5js &lt;https://p5js.org/&gt;`_</span>
<span class="sd">environment. I made this because I have used Processing extensively in</span>
<span class="sd">the past, and would like a simple interface to draw stuff. Processing</span>
<span class="sd">doesn&#39;t really exist on Python (yes, I know of Processing&#39;s python mode,</span>
<span class="sd">but it&#39;s Jython, not pure python!), so I made this based upon the</span>
<span class="sd">`drawsvg &lt;https://github.com/cduck/drawSvg&gt;`_ library. Download that</span>
<span class="sd">before using this module. Example::</span>

<span class="sd">    from k1lib.imports import *</span>

<span class="sd">    p5.newSketch(200, 200); p5.background(150)</span>
<span class="sd">    p5.rect(0, 0, 60, 60)</span>
<span class="sd">    with p5.context(): # all style changes here will be reverted on exiting the context</span>
<span class="sd">        p5.fill(255, 0, 0)</span>
<span class="sd">        p5.rect(0, 0, 60, 50)</span>
<span class="sd">    p5.rect(0, 0, 30, 30)</span>
<span class="sd">    p5.fill(255, 180); p5.ellipse(60, 50, 20)</span>
<span class="sd">    p5.textSize(12); p5.text(&quot;abc&quot;, 30, 30)</span>
<span class="sd">    with p5.context():</span>
<span class="sd">        p5.fill(0, 0, 255); p5.noStroke(); p5.textSize(20)</span>
<span class="sd">        p5.text(&quot;def&quot;, 60, 60)</span>
<span class="sd">    p5.img() # get PIL image</span>

<span class="sd">Result:</span>

<span class="sd">.. image:: images/p5.png&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">k1lib</span><span class="o">,</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">random</span><span class="p">;</span> <span class="kn">import</span> <span class="nn">k1lib.cli</span> <span class="k">as</span> <span class="nn">cli</span><span class="p">;</span> <span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Iterator</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">deque</span>
<span class="n">drawsvg</span> <span class="o">=</span> <span class="n">k1lib</span><span class="o">.</span><span class="n">dep</span><span class="p">(</span><span class="s2">&quot;drawsvg&quot;</span><span class="p">,</span> <span class="s2">&quot;drawsvg[all]&quot;</span><span class="p">,</span> <span class="s2">&quot;https://github.com/cduck/drawSvg&quot;</span><span class="p">)</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="s2">&quot;newSketch&quot;</span><span class="p">,</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span> <span class="s2">&quot;noFill&quot;</span><span class="p">,</span> <span class="s2">&quot;stroke&quot;</span><span class="p">,</span> <span class="s2">&quot;noStroke&quot;</span><span class="p">,</span> <span class="s2">&quot;ellipse&quot;</span><span class="p">,</span> <span class="s2">&quot;rect&quot;</span><span class="p">,</span> <span class="s2">&quot;textSize&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;background&quot;</span><span class="p">,</span> <span class="s2">&quot;img&quot;</span><span class="p">,</span>
           <span class="s2">&quot;Entity&quot;</span><span class="p">,</span> <span class="s2">&quot;point_raw&quot;</span><span class="p">,</span> <span class="s2">&quot;point_rnd&quot;</span><span class="p">,</span> <span class="s2">&quot;point_sym&quot;</span><span class="p">,</span> <span class="s2">&quot;point_L&quot;</span><span class="p">,</span> <span class="s2">&quot;triangle&quot;</span><span class="p">,</span> <span class="s2">&quot;line_2P&quot;</span><span class="p">,</span> <span class="s2">&quot;line_2PL&quot;</span><span class="p">,</span> <span class="s2">&quot;circle_PR&quot;</span><span class="p">,</span> <span class="s2">&quot;circle_2P&quot;</span><span class="p">,</span> <span class="s2">&quot;grid&quot;</span><span class="p">,</span> <span class="s2">&quot;axes&quot;</span><span class="p">]</span>
<div class="viewcode-block" id="color"><a class="viewcode-back" href="../../p5.html#k1lib.p5.color">[docs]</a><span class="k">def</span> <span class="nf">color</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">255</span><span class="p">):</span>                                         <span class="c1"># color</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get hex representation of a color.</span>
<span class="sd">Example::</span>

<span class="sd">    p5.color(255, 0, 0) # returns &quot;#ff0000ff&quot;, red</span>
<span class="sd">    p5.color(255, 0, 0, 100) # returns &quot;#ff000064&quot;, transparent red</span>
<span class="sd">    p5.color(255, 100) # returns &quot;#ffffff64&quot;, transparent white&quot;&quot;&quot;</span>               <span class="c1"># color</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>                                                       <span class="c1"># color</span>
        <span class="k">if</span> <span class="n">g</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Doesn&#39;t understand this color specification: </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">g</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># color</span>
        <span class="n">r</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>                                                   <span class="c1"># color</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span> <span class="k">return</span> <span class="n">r</span> <span class="o">+</span> <span class="s2">&quot;ff&quot;</span>                                          <span class="c1"># color</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span> <span class="k">return</span> <span class="n">r</span>                                               <span class="c1"># color</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Doesn&#39;t understand this string color: </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>      <span class="c1"># color</span>
    <span class="k">if</span> <span class="n">g</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">g</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">r</span>                                     <span class="c1"># color</span>
    <span class="k">if</span> <span class="n">g</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">g</span><span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">r</span>                      <span class="c1"># color</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;#</span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s2">02x</span><span class="si">}{</span><span class="n">g</span><span class="si">:</span><span class="s2">02x</span><span class="si">}{</span><span class="n">b</span><span class="si">:</span><span class="s2">02x</span><span class="si">}{</span><span class="n">alpha</span><span class="si">:</span><span class="s2">02x</span><span class="si">}</span><span class="s2">&quot;</span>                                  <span class="c1"># color</span></div>
<span class="n">c</span> <span class="o">=</span> <span class="n">k1lib</span><span class="o">.</span><span class="n">Settings</span><span class="p">();</span>                                                            <span class="c1"># color</span>
<span class="n">context</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">context</span>                                                              <span class="c1"># color</span>
<span class="k">def</span> <span class="nf">_strokeAlpha</span><span class="p">():</span> <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">stroke</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="mi">16</span><span class="p">)</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">stroke</span> <span class="k">else</span> <span class="mi">255</span>           <span class="c1"># _strokeAlpha</span>
<span class="k">def</span> <span class="nf">_fillAlpha</span><span class="p">():</span> <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">fill</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="mi">16</span><span class="p">)</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">fill</span> <span class="k">else</span> <span class="mi">255</span>                 <span class="c1"># _fillAlpha</span>
<span class="k">def</span> <span class="nf">_alpha</span><span class="p">():</span> <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">_strokeAlpha</span><span class="p">(),</span> <span class="n">_fillAlpha</span><span class="p">())</span>                           <span class="c1"># _alpha</span>
<span class="k">def</span> <span class="nf">_cs</span><span class="p">():</span> <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;fill&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">fill</span><span class="p">,</span> <span class="s2">&quot;stroke&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">stroke</span><span class="p">,</span> <span class="s2">&quot;fill_opacity&quot;</span><span class="p">:</span> <span class="n">_fillAlpha</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="s2">&quot;stroke_opacity&quot;</span><span class="p">:</span> <span class="n">_strokeAlpha</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span><span class="p">}</span> <span class="c1"># colors shorthand # _cs</span>
<div class="viewcode-block" id="newSketch"><a class="viewcode-back" href="../../p5.html#k1lib.p5.newSketch">[docs]</a><span class="k">def</span> <span class="nf">newSketch</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>                                                             <span class="c1"># newSketch</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a new sketch with specified height and width&quot;&quot;&quot;</span>                   <span class="c1"># newSketch</span>
    <span class="n">c</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">drawsvg</span><span class="o">.</span><span class="n">Drawing</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">);</span> <span class="n">c</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">;</span> <span class="n">c</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">h</span>                                <span class="c1"># newSketch</span>
    <span class="n">c</span><span class="o">.</span><span class="n">stroke</span> <span class="o">=</span> <span class="n">color</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">c</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">color</span><span class="p">(</span><span class="mi">255</span><span class="p">);</span> <span class="n">c</span><span class="o">.</span><span class="n">fontSize</span> <span class="o">=</span> <span class="mi">12</span>                    <span class="c1"># newSketch</span></div>
<div class="viewcode-block" id="fill"><a class="viewcode-back" href="../../p5.html#k1lib.p5.fill">[docs]</a><span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>                                                                 <span class="c1"># fill</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets fill color&quot;&quot;&quot;</span>                                                        <span class="c1"># fill</span>
    <span class="n">c</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">color</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>                                                        <span class="c1"># fill</span></div>
<div class="viewcode-block" id="noFill"><a class="viewcode-back" href="../../p5.html#k1lib.p5.noFill">[docs]</a><span class="k">def</span> <span class="nf">noFill</span><span class="p">():</span>                                                                    <span class="c1"># noFill</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Turns off fill color&quot;&quot;&quot;</span>                                                   <span class="c1"># noFill</span>
    <span class="n">c</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>                                                       <span class="c1"># noFill</span></div>
<div class="viewcode-block" id="stroke"><a class="viewcode-back" href="../../p5.html#k1lib.p5.stroke">[docs]</a><span class="k">def</span> <span class="nf">stroke</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>                                                               <span class="c1"># stroke</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets stroke color&quot;&quot;&quot;</span>                                                      <span class="c1"># stroke</span>
    <span class="n">c</span><span class="o">.</span><span class="n">stroke</span> <span class="o">=</span> <span class="n">color</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>                                                      <span class="c1"># stroke</span></div>
<div class="viewcode-block" id="noStroke"><a class="viewcode-back" href="../../p5.html#k1lib.p5.noStroke">[docs]</a><span class="k">def</span> <span class="nf">noStroke</span><span class="p">():</span>                                                                  <span class="c1"># noStroke</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Turns off stroke color&quot;&quot;&quot;</span>                                                 <span class="c1"># noStroke</span>
    <span class="n">c</span><span class="o">.</span><span class="n">stroke</span> <span class="o">=</span> <span class="n">color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>                                                     <span class="c1"># noStroke</span></div>
<div class="viewcode-block" id="ellipse"><a class="viewcode-back" href="../../p5.html#k1lib.p5.ellipse">[docs]</a><span class="k">def</span> <span class="nf">ellipse</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>                                                            <span class="c1"># ellipse</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws a circle at a particular location. Can&#39;t truly draw ellipses cause idk how&quot;&quot;&quot;</span> <span class="c1"># ellipse</span>
    <span class="n">c</span><span class="o">.</span><span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drawsvg</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">h</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">_cs</span><span class="p">()))</span>                           <span class="c1"># ellipse</span></div>
<span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">):</span>                                                           <span class="c1"># line</span>
    <span class="n">c</span><span class="o">.</span><span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drawsvg</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">c</span><span class="o">.</span><span class="n">h</span><span class="o">-</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">c</span><span class="o">.</span><span class="n">h</span><span class="o">-</span><span class="n">y2</span><span class="p">,</span><span class="o">**</span><span class="n">_cs</span><span class="p">()))</span>                        <span class="c1"># line</span>
<div class="viewcode-block" id="rect"><a class="viewcode-back" href="../../p5.html#k1lib.p5.rect">[docs]</a><span class="k">def</span> <span class="nf">rect</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>                                                       <span class="c1"># rect</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws a rectangle.</span>

<span class="sd">:param r: border radius&quot;&quot;&quot;</span>                                                       <span class="c1"># rect</span>
    <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drawsvg</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">h</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">**</span><span class="n">_cs</span><span class="p">()))</span>           <span class="c1"># rect</span>
    <span class="k">else</span><span class="p">:</span>                                                                        <span class="c1"># rect</span>
        <span class="n">c</span><span class="o">.</span><span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drawsvg</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="o">**</span><span class="n">_cs</span><span class="p">())</span>                                         <span class="c1"># rect</span>
           <span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">h</span><span class="o">-</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="n">r</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>                                      <span class="c1"># rect</span>
           <span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">h</span><span class="o">-</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="o">-</span><span class="n">r</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="n">includeL</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                    <span class="c1"># rect</span>
           <span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">h</span><span class="o">-</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="o">-</span><span class="n">r</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">includeL</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                    <span class="c1"># rect</span>
           <span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">h</span><span class="o">-</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="n">r</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">includeL</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">h</span><span class="o">-</span><span class="n">y</span><span class="p">))</span>        <span class="c1"># rect</span></div>
<div class="viewcode-block" id="textSize"><a class="viewcode-back" href="../../p5.html#k1lib.p5.textSize">[docs]</a><span class="k">def</span> <span class="nf">textSize</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>                                                                 <span class="c1"># textSize</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the text size&quot;&quot;&quot;</span>                                                     <span class="c1"># textSize</span>
    <span class="n">c</span><span class="o">.</span><span class="n">fontSize</span> <span class="o">=</span> <span class="n">s</span>                                                               <span class="c1"># textSize</span></div>
<div class="viewcode-block" id="text"><a class="viewcode-back" href="../../p5.html#k1lib.p5.text">[docs]</a><span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>                                                               <span class="c1"># text</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws text at a specific location&quot;&quot;&quot;</span>                                      <span class="c1"># text</span>
    <span class="n">c</span><span class="o">.</span><span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drawsvg</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">fontSize</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">h</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">_cs</span><span class="p">()))</span>                   <span class="c1"># text</span></div>
<div class="viewcode-block" id="background"><a class="viewcode-back" href="../../p5.html#k1lib.p5.background">[docs]</a><span class="k">def</span> <span class="nf">background</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>                                                           <span class="c1"># background</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Changes the background color&quot;&quot;&quot;</span>                                           <span class="c1"># background</span>
    <span class="k">with</span> <span class="n">c</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="n">color</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)):</span> <span class="n">rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">h</span><span class="o">-</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">w</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="o">.</span><span class="n">h</span><span class="p">)</span> <span class="c1"># background</span></div>
<div class="viewcode-block" id="img"><a class="viewcode-back" href="../../p5.html#k1lib.p5.img">[docs]</a><span class="k">def</span> <span class="nf">img</span><span class="p">():</span>                                                                       <span class="c1"># img</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a PIL image of the sketch&quot;&quot;&quot;</span>                                      <span class="c1"># img</span>
    <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">d</span><span class="o">.</span><span class="n">rasterize</span><span class="p">()</span><span class="o">.</span><span class="n">png_data</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">toImg</span><span class="p">()</span>                                <span class="c1"># img</span></div>
<span class="k">def</span> <span class="nf">svg</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>                                                                <span class="c1"># svg</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns svg string of the sketch&quot;&quot;&quot;</span>                                       <span class="c1"># svg</span>
    <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">d</span><span class="o">.</span><span class="n">asSvg</span><span class="p">()</span>                                                           <span class="c1"># svg</span>
<span class="n">inf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>                                                               <span class="c1"># svg</span>
<div class="viewcode-block" id="Entity"><a class="viewcode-back" href="../../p5.html#k1lib.p5.Entity">[docs]</a><span class="k">class</span> <span class="nc">Entity</span><span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">BaseCli</span><span class="p">):</span>                                                       <span class="c1"># Entity</span>
<div class="viewcode-block" id="Entity.__init__"><a class="viewcode-back" href="../../p5.html#k1lib.p5.Entity.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>                                                   <span class="c1"># Entity</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Geometry-building package.</span>

<span class="sd">So, within p5 module, there&#39;s sort of like a submodule that deals with geometrical data</span>
<span class="sd">that allows you to define things like in Geogebra, whose work I&#39;m a huge fan of. Here&#39;s</span>
<span class="sd">how it works::</span>

<span class="sd">    # creates an IR (intermediate representation) that defines 2 points and a line connecting the 2 points</span>
<span class="sd">    ir = None | p5.point_raw(&quot;P1&quot;, 3, 4) | p5.point_raw(&quot;P2&quot;, 5, 8) | p5.line_2P(&quot;L1&quot;, &quot;P1&quot;, &quot;P2&quot;)</span>
<span class="sd">    # calculates the exact position of all entities within the IR, and calculate some meta information</span>
<span class="sd">    ir = ir | aS(p5.IR.calc) | aS(p5.IR.calcMeta)</span>
<span class="sd">    # create a p5 sketch, setup some initial variables</span>
<span class="sd">    p5.newSketch(400, 400); p5.background(155); p5.textSize(16)</span>
<span class="sd">    # creates an image from the IR</span>
<span class="sd">    IR.display(ir); im = p5.img()</span>

<span class="sd">The idea is, you can define the sketch however you like, with relationships between them (like how</span>
<span class="sd">a line is made of 2 points, or construct a circle with a specified center that passes through another</span>
<span class="sd">point). After that, you&#39;ll receive the IR, which is a simple object that can be turned into a json</span>
<span class="sd">that can be understood by other parts of your system.</span>

<span class="sd">After you got the IR, you can calculate the precise location of every element with :meth:`IR.calc`.</span>
<span class="sd">Then you can calculate extra metadata about the viewing frame to display it on with :meth:`IR.calcMeta`.</span>
<span class="sd">Finally, you can do :meth:`IR.display`</span>
<span class="sd">&quot;&quot;&quot;</span>                                                                              <span class="c1"># Entity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irL</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>                                        <span class="c1"># Entity</span></div>
<div class="viewcode-block" id="Entity.__ror__"><a class="viewcode-back" href="../../p5.html#k1lib.p5.Entity.__ror__">[docs]</a>    <span class="k">def</span> <span class="fm">__ror__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ir</span><span class="p">):</span> <span class="n">ir</span> <span class="o">=</span> <span class="n">ir</span> <span class="ow">or</span> <span class="p">{</span><span class="s2">&quot;def&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">};</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">irL</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">irL</span><span class="p">;</span> <span class="k">return</span> <span class="n">ir</span> <span class="c1"># Entity</span></div>
<div class="viewcode-block" id="Entity.dependsOn"><a class="viewcode-back" href="../../p5.html#k1lib.p5.Entity.dependsOn">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># Entity</span>
    <span class="k">def</span> <span class="nf">dependsOn</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="k">return</span> <span class="p">[]</span>                    <span class="c1"># Entity</span></div>
<div class="viewcode-block" id="Entity.calc"><a class="viewcode-back" href="../../p5.html#k1lib.p5.Entity.calc">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># Entity</span>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span> <span class="k">return</span> <span class="bp">NotImplemented</span>              <span class="c1"># Entity</span></div>
<div class="viewcode-block" id="Entity.bounds"><a class="viewcode-back" href="../../p5.html#k1lib.p5.Entity.bounds">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># Entity</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span> <span class="k">return</span> <span class="p">[</span><span class="n">inf</span><span class="p">,</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span><span class="n">inf</span><span class="p">,</span><span class="o">-</span><span class="n">inf</span><span class="p">]</span> <span class="c1"># calculates the bounds of the object: xmin, xmax, ymin, ymax # Entity</span></div>
<div class="viewcode-block" id="Entity.display"><a class="viewcode-back" href="../../p5.html#k1lib.p5.Entity.display">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># Entity</span>
    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">meta</span><span class="p">):</span> <span class="k">pass</span> <span class="c1"># meta = [transXY (lambda), scale: (lambda)] # Entity</span></div></div>
<span class="k">class</span> <span class="nc">Point</span><span class="p">(</span><span class="n">Entity</span><span class="p">):</span> <span class="c1"># final coordinate format: [x, y]                           # Point</span>
    <span class="nd">@classmethod</span>                                                                 <span class="c1"># Point</span>
    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>                                                    <span class="c1"># Point</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">];</span> <span class="n">props</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;stroke&quot;</span><span class="p">:</span> <span class="s2">&quot;#ff0000&quot;</span><span class="p">},</span><span class="o">**</span><span class="p">(</span><span class="n">o</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">or</span> <span class="p">{})}</span>    <span class="c1"># Point</span>
        <span class="k">if</span> <span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span> <span class="k">return</span>                          <span class="c1"># Point</span>
        <span class="k">if</span> <span class="s2">&quot;stroke&quot;</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span> <span class="n">stroke</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;stroke&quot;</span><span class="p">])</span>                            <span class="c1"># Point</span>
        <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">o</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span> <span class="n">fill</span><span class="p">(</span><span class="mi">255</span><span class="p">);</span> <span class="n">ellipse</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">text</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span><span class="n">x</span><span class="o">+</span><span class="mi">6</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># Point</span>
    <span class="nd">@classmethod</span>                                                                 <span class="c1"># Point</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">):</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">y</span><span class="p">]</span>          <span class="c1"># Point</span>
<div class="viewcode-block" id="point_rnd"><a class="viewcode-back" href="../../p5.html#k1lib.p5.point_rnd">[docs]</a><span class="k">def</span> <span class="nf">point_rnd</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">props</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>                                             <span class="c1"># point_rnd</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a point with a random location. See also: :class:`Entity`</span>

<span class="sd">:param name: name of point&quot;&quot;&quot;</span>                                                    <span class="c1"># point_rnd</span>
    <span class="k">return</span> <span class="n">point_raw</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">props</span><span class="p">)</span>                           <span class="c1"># point_rnd</span></div>
<div class="viewcode-block" id="point_raw"><a class="viewcode-back" href="../../p5.html#k1lib.p5.point_raw">[docs]</a><span class="k">class</span> <span class="nc">point_raw</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>                                                          <span class="c1"># point_raw</span>
<div class="viewcode-block" id="point_raw.__init__"><a class="viewcode-back" href="../../p5.html#k1lib.p5.point_raw.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">x</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">props</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>                      <span class="c1"># point_raw</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a point from actual raw coordinates. See also: :class:`Entity`</span>

<span class="sd">:param name: name of point</span>
<span class="sd">:param x: position on x axis</span>
<span class="sd">:param y: position on y axis&quot;&quot;&quot;</span>                                                  <span class="c1"># point_raw</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irL</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;point_raw&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">props</span><span class="p">,</span> <span class="p">[]]</span>                        <span class="c1"># point_raw</span></div>
<div class="viewcode-block" id="point_raw.dependsOn"><a class="viewcode-back" href="../../p5.html#k1lib.p5.point_raw.dependsOn">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># point_raw</span>
    <span class="k">def</span> <span class="nf">dependsOn</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="k">return</span> <span class="p">[]</span>                                    <span class="c1"># point_raw</span></div>
<div class="viewcode-block" id="point_raw.calc"><a class="viewcode-back" href="../../p5.html#k1lib.p5.point_raw.calc">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># point_raw</span>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="k">return</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>                         <span class="c1"># point_raw</span></div></div>
<div class="viewcode-block" id="point_sym"><a class="viewcode-back" href="../../p5.html#k1lib.p5.point_sym">[docs]</a><span class="k">class</span> <span class="nc">point_sym</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>                                                          <span class="c1"># point_sym</span>
<div class="viewcode-block" id="point_sym.__init__"><a class="viewcode-back" href="../../p5.html#k1lib.p5.point_sym.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">p1</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">pm</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">props</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>                        <span class="c1"># point_sym</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a point which is symmetric to point &quot;p1&quot; around point &quot;pm&quot;.</span>
<span class="sd">Basically, &quot;pm&quot; is the midpoint of &quot;p1&quot; and the new point. See also: :class:`Entity`</span>

<span class="sd">:param name: name of point</span>
<span class="sd">:param p1: name of the other point</span>
<span class="sd">:param pm: name of the middle point&quot;&quot;&quot;</span>                                           <span class="c1"># point_sym</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irL</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;point_sym&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span><span class="n">pm</span><span class="p">],</span> <span class="n">props</span><span class="p">,</span> <span class="p">[]]</span> <span class="c1"># point 1 and point mid # point_sym</span></div>
<div class="viewcode-block" id="point_sym.dependsOn"><a class="viewcode-back" href="../../p5.html#k1lib.p5.point_sym.dependsOn">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># point_sym</span>
    <span class="k">def</span> <span class="nf">dependsOn</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="k">return</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>                    <span class="c1"># point_sym</span></div>
<div class="viewcode-block" id="point_sym.calc"><a class="viewcode-back" href="../../p5.html#k1lib.p5.point_sym.calc">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># point_sym</span>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="n">p1</span><span class="p">,</span><span class="n">pm</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">p1</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="n">xm</span><span class="p">,</span><span class="n">ym</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">pm</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">xm</span><span class="o">-</span><span class="n">x1</span><span class="p">;</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">ym</span><span class="o">-</span><span class="n">y1</span><span class="p">;</span> <span class="k">return</span> <span class="p">[</span><span class="n">x1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="n">y1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">dy</span><span class="p">]</span> <span class="c1"># point_sym</span></div></div>
<div class="viewcode-block" id="point_L"><a class="viewcode-back" href="../../p5.html#k1lib.p5.point_L">[docs]</a><span class="k">class</span> <span class="nc">point_L</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>                                                            <span class="c1"># point_L</span>
<div class="viewcode-block" id="point_L.__init__"><a class="viewcode-back" href="../../p5.html#k1lib.p5.point_L.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">l1</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">f</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">props</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>                       <span class="c1"># point_L</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a point on a line at a particular fraction.</span>
<span class="sd">If &quot;f&quot; is 0.1, it&#39;ll be close to the first point of the line,</span>
<span class="sd">if &quot;f&quot; is 0.9, it&#39;ll be close to the second point of the line.</span>

<span class="sd">:param name: name of point</span>
<span class="sd">:param l1: name of line that the point is on</span>
<span class="sd">:param f: fraction between the 2 points on the line. Can be any number, not just from 0 to 1&quot;&quot;&quot;</span> <span class="c1"># point_L</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irL</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;point_L&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">l1</span><span class="p">,</span><span class="n">f</span><span class="p">],</span> <span class="n">props</span><span class="p">,</span> <span class="p">[]]</span>                          <span class="c1"># point_L</span></div>
<div class="viewcode-block" id="point_L.dependsOn"><a class="viewcode-back" href="../../p5.html#k1lib.p5.point_L.dependsOn">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># point_L</span>
    <span class="k">def</span> <span class="nf">dependsOn</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="k">return</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">][:</span><span class="mi">1</span><span class="p">]</span>                <span class="c1"># point_L</span></div>
<div class="viewcode-block" id="point_L.calc"><a class="viewcode-back" href="../../p5.html#k1lib.p5.point_L.calc">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># point_L</span>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="n">l1</span><span class="p">,</span><span class="n">f</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">l1</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="k">return</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">f</span><span class="p">)</span><span class="o">+</span><span class="n">x2</span><span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="n">y1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">f</span><span class="p">)</span><span class="o">+</span><span class="n">y2</span><span class="o">*</span><span class="n">f</span> <span class="c1"># point_L</span></div></div>
<div class="viewcode-block" id="triangle"><a class="viewcode-back" href="../../p5.html#k1lib.p5.triangle">[docs]</a><span class="k">def</span> <span class="nf">triangle</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">p2</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">p3</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">props1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">props2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">props3</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>          <span class="c1"># triangle</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates 3 random points that looks like a reasonable triangle,</span>
<span class="sd">with flat base and pointy upward tip.</span>

<span class="sd">:param p1: name of first point</span>
<span class="sd">:param props1: optional properties of the first point&quot;&quot;&quot;</span>                         <span class="c1"># triangle</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>                                                                  <span class="c1"># triangle</span>
        <span class="n">ya</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                              <span class="c1"># triangle</span>
        <span class="k">if</span> <span class="n">ya</span> <span class="o">&lt;</span> <span class="n">yb</span><span class="p">:</span> <span class="n">ya</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">yb</span><span class="p">,</span> <span class="n">ya</span>                                              <span class="c1"># triangle</span>
        <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                              <span class="c1"># triangle</span>
        <span class="k">if</span> <span class="n">x2</span> <span class="o">&gt;</span> <span class="n">x3</span><span class="p">:</span> <span class="n">x2</span><span class="p">,</span><span class="n">x3</span> <span class="o">=</span> <span class="n">x3</span><span class="p">,</span><span class="n">x2</span>                                                <span class="c1"># triangle</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">x2</span><span class="o">+</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="n">x3</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span>                                          <span class="c1"># triangle</span>
        <span class="k">if</span> <span class="mf">0.3</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ya</span><span class="o">-</span><span class="n">yb</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">x3</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span> <span class="k">break</span>                                <span class="c1"># triangle</span>
    <span class="k">return</span> <span class="n">point_raw</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">ya</span><span class="p">,</span><span class="n">props1</span><span class="p">)</span> <span class="o">|</span> <span class="n">point_raw</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">yb</span><span class="p">,</span><span class="n">props2</span><span class="p">)</span> <span class="o">|</span> <span class="n">point_raw</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="n">yb</span><span class="p">,</span><span class="n">props3</span><span class="p">)</span> <span class="c1"># triangle</span></div>
<span class="k">class</span> <span class="nc">Line</span><span class="p">(</span><span class="n">Entity</span><span class="p">):</span> <span class="c1"># final coordinate format: [x1, y1, x2, y2]                  # Line</span>
    <span class="nd">@classmethod</span>                                                                 <span class="c1"># Line</span>
    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>                                                    <span class="c1"># Line</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">];</span> <span class="n">props</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;stroke&quot;</span><span class="p">:</span> <span class="s2">&quot;#0000ff&quot;</span><span class="p">},</span><span class="o">**</span><span class="p">(</span><span class="n">o</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">or</span> <span class="p">{})}</span>    <span class="c1"># Line</span>
        <span class="k">if</span> <span class="n">props</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span> <span class="k">return</span>    <span class="c1"># Line</span>
        <span class="k">if</span> <span class="s2">&quot;stroke&quot;</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span> <span class="n">stroke</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;stroke&quot;</span><span class="p">])</span>                            <span class="c1"># Line</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="o">=</span> <span class="n">o</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">batched</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="n">cli</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">joinSt</span><span class="p">();</span> <span class="n">line</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">);</span> <span class="n">text</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">),(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="n">y1</span><span class="o">+</span><span class="n">y2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># Line</span>
    <span class="nd">@classmethod</span>                                                                 <span class="c1"># Line</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">):</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="k">return</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">)]</span> <span class="c1"># Line</span>
<span class="k">class</span> <span class="nc">line_P</span><span class="p">(</span><span class="n">Line</span><span class="p">):</span>                                                              <span class="c1"># line_P</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">p1</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">angle</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">l</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">f</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">props</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> <span class="c1"># line_P</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a line that passes through a point, with an angle from the x axis, a specific length and a specific point fraction.</span>

<span class="sd">:param name: name of line</span>
<span class="sd">:param p1: name of point</span>
<span class="sd">:param angle: angle with respect to the x axis</span>
<span class="sd">:param l: length of the line</span>
<span class="sd">:param f: fraction of the line the point is located at&quot;&quot;&quot;</span>                        <span class="c1"># line_P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irL</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;line_P&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span><span class="n">angle</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">f</span><span class="p">],</span> <span class="n">props</span><span class="p">,</span> <span class="p">[]]</span>                   <span class="c1"># line_P</span>
    <span class="nd">@classmethod</span>                                                                 <span class="c1"># line_P</span>
    <span class="k">def</span> <span class="nf">dependsOn</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="k">return</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">][:</span><span class="mi">1</span><span class="p">]</span>                <span class="c1"># line_P</span>
    <span class="nd">@classmethod</span>                                                                 <span class="c1"># line_P</span>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="n">p1</span><span class="p">,</span><span class="n">angle</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">f</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">p1</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">*</span><span class="n">l</span><span class="p">;</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">*</span><span class="n">l</span><span class="p">;</span> <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">dx</span><span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">dy</span><span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">dx</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">f</span><span class="p">),</span> <span class="n">y</span><span class="o">+</span><span class="n">dy</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">f</span><span class="p">)]</span><span class="c1">#return [x-dx*(1-f), y-dy*(1-f), x+dx*f, y+dy*f] # line_P</span>
<div class="viewcode-block" id="line_2P"><a class="viewcode-back" href="../../p5.html#k1lib.p5.line_2P">[docs]</a><span class="k">class</span> <span class="nc">line_2P</span><span class="p">(</span><span class="n">Line</span><span class="p">):</span>                                                             <span class="c1"># line_2P</span>
<div class="viewcode-block" id="line_2P.__init__"><a class="viewcode-back" href="../../p5.html#k1lib.p5.line_2P.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">p1</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">p2</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">prevF</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">nextF</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">props</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> <span class="c1"># line_2P</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a line that connects 2 points together. See also: :class:`Entity`</span>

<span class="sd">:param name: name of line</span>
<span class="sd">:param p1: name of first point</span>
<span class="sd">:param p2: name of second point</span>
<span class="sd">:param prevF: &quot;previous fraction&quot;. How much should the line extend past</span>
<span class="sd">    the first point as a fraction of the distance between p1 and p2</span>
<span class="sd">:param nextF: &quot;next fraction&quot;. How much should the line extend past</span>
<span class="sd">    the second point as a fraction of the distance between p1 and p2</span>
<span class="sd">&quot;&quot;&quot;</span>                                                                              <span class="c1"># line_2P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irL</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;line_2P&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">prevF</span><span class="p">,</span> <span class="n">nextF</span><span class="p">],</span> <span class="n">props</span><span class="p">,</span> <span class="p">[]]</span>          <span class="c1"># line_2P</span></div>
<div class="viewcode-block" id="line_2P.dependsOn"><a class="viewcode-back" href="../../p5.html#k1lib.p5.line_2P.dependsOn">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># line_2P</span>
    <span class="k">def</span> <span class="nf">dependsOn</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="k">return</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>                <span class="c1"># line_2P</span></div>
<div class="viewcode-block" id="line_2P.calc"><a class="viewcode-back" href="../../p5.html#k1lib.p5.line_2P.calc">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># line_2P</span>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>                                                   <span class="c1"># line_2P</span>
        <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">prevF</span><span class="p">,</span> <span class="n">nextF</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">p1</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">p2</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">;</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span> <span class="c1"># line_2P</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x1</span><span class="o">-</span><span class="n">dx</span><span class="o">*</span><span class="n">prevF</span><span class="p">,</span><span class="n">y1</span><span class="o">-</span><span class="n">dy</span><span class="o">*</span><span class="n">prevF</span><span class="p">,</span><span class="n">x2</span><span class="o">+</span><span class="n">dx</span><span class="o">*</span><span class="n">nextF</span><span class="p">,</span><span class="n">y2</span><span class="o">+</span><span class="n">dy</span><span class="o">*</span><span class="n">nextF</span><span class="p">]</span>                 <span class="c1"># line_2P</span></div></div>
<div class="viewcode-block" id="line_2PL"><a class="viewcode-back" href="../../p5.html#k1lib.p5.line_2PL">[docs]</a><span class="k">class</span> <span class="nc">line_2PL</span><span class="p">(</span><span class="n">Line</span><span class="p">):</span>                                                            <span class="c1"># line_2PL</span>
<div class="viewcode-block" id="line_2PL.__init__"><a class="viewcode-back" href="../../p5.html#k1lib.p5.line_2PL.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">p1</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">p2</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">l</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">props</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>                <span class="c1"># line_2PL</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a line that connects 2 points together that starts at the first</span>
<span class="sd">point and has specific length. If extended indefinitely, it will pass through the</span>
<span class="sd">second point, but in its normal state, it doesn&#39;t have to pass through or can</span>
<span class="sd">overshoot the second point. Useful for creating rays. See also: :class:`Entity`</span>

<span class="sd">:param name: name of the line</span>
<span class="sd">:param p1: name of first point</span>
<span class="sd">:param p2: name of second point</span>
<span class="sd">:param l: length of line</span>
<span class="sd">&quot;&quot;&quot;</span>                                                                              <span class="c1"># line_2PL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irL</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;line_2PL&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">p2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">l</span><span class="p">],</span> <span class="n">props</span><span class="p">,</span> <span class="p">[]]</span>                      <span class="c1"># line_2PL</span></div>
<div class="viewcode-block" id="line_2PL.dependsOn"><a class="viewcode-back" href="../../p5.html#k1lib.p5.line_2PL.dependsOn">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># line_2PL</span>
    <span class="k">def</span> <span class="nf">dependsOn</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="k">return</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span>                <span class="c1"># line_2PL</span></div>
<div class="viewcode-block" id="line_2PL.calc"><a class="viewcode-back" href="../../p5.html#k1lib.p5.line_2PL.calc">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># line_2PL</span>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="k">pass</span>                                              <span class="c1"># line_2PL</span></div></div>
<span class="k">class</span> <span class="nc">Circle</span><span class="p">(</span><span class="n">Entity</span><span class="p">):</span> <span class="c1"># final coordinate format: [x, y, r]                       # Circle</span>
    <span class="nd">@classmethod</span>                                                                 <span class="c1"># Circle</span>
    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>                                                    <span class="c1"># Circle</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">];</span> <span class="n">props</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;stroke&quot;</span><span class="p">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">},</span><span class="o">**</span><span class="p">(</span><span class="n">o</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">or</span> <span class="p">{})}</span>    <span class="c1"># Circle</span>
        <span class="k">if</span> <span class="n">props</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span> <span class="k">return</span>    <span class="c1"># Circle</span>
        <span class="k">if</span> <span class="s2">&quot;stroke&quot;</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span> <span class="n">stroke</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;stroke&quot;</span><span class="p">])</span>                            <span class="c1"># Circle</span>
        <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="n">o</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">](</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span> <span class="n">r</span> <span class="o">*=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span> <span class="n">ellipse</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">r</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span> <span class="n">text</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span><span class="n">x</span><span class="o">+</span><span class="n">r</span><span class="o">*</span><span class="mf">1.1</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="c1"># Circle</span>
    <span class="nd">@classmethod</span>                                                                 <span class="c1"># Circle</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">):</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">r</span><span class="p">,</span><span class="n">x</span><span class="o">+</span><span class="n">r</span><span class="p">,</span><span class="n">y</span><span class="o">-</span><span class="n">r</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">r</span><span class="p">]</span> <span class="c1"># Circle</span>
<div class="viewcode-block" id="circle_PR"><a class="viewcode-back" href="../../p5.html#k1lib.p5.circle_PR">[docs]</a><span class="k">class</span> <span class="nc">circle_PR</span><span class="p">(</span><span class="n">Circle</span><span class="p">):</span> <span class="c1"># circle from center point and radius                   # circle_PR</span>
<div class="viewcode-block" id="circle_PR.__init__"><a class="viewcode-back" href="../../p5.html#k1lib.p5.circle_PR.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">p1</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">radius</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">props</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>                  <span class="c1"># circle_PR</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a circle from a center point and a radius. See also: :class:`Entity`</span>

<span class="sd">:param name: name of circle</span>
<span class="sd">:param p1: name of the center point</span>
<span class="sd">:param radius: radius of the circle&quot;&quot;&quot;</span>                                           <span class="c1"># circle_PR</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irL</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;circle_PR&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">radius</span><span class="p">],</span> <span class="n">props</span><span class="p">,</span> <span class="p">[]]</span>                  <span class="c1"># circle_PR</span></div>
<div class="viewcode-block" id="circle_PR.dependsOn"><a class="viewcode-back" href="../../p5.html#k1lib.p5.circle_PR.dependsOn">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># circle_PR</span>
    <span class="k">def</span> <span class="nf">dependsOn</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="k">return</span> <span class="p">[</span><span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>               <span class="c1"># circle_PR</span></div>
<div class="viewcode-block" id="circle_PR.calc"><a class="viewcode-back" href="../../p5.html#k1lib.p5.circle_PR.calc">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># circle_PR</span>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="n">o</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span> <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">4</span><span class="p">],</span> <span class="n">o</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="c1"># circle_PR</span></div></div>
<div class="viewcode-block" id="circle_2P"><a class="viewcode-back" href="../../p5.html#k1lib.p5.circle_2P">[docs]</a><span class="k">class</span> <span class="nc">circle_2P</span><span class="p">(</span><span class="n">Circle</span><span class="p">):</span> <span class="c1"># circle that has center pc and passes through point p2 # circle_2P</span>
<div class="viewcode-block" id="circle_2P.__init__"><a class="viewcode-back" href="../../p5.html#k1lib.p5.circle_2P.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">pc</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">p2</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">props</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>                        <span class="c1"># circle_2P</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a circle from a center point that passes through another</span>
<span class="sd">point. See also: :class:`Entity`</span>

<span class="sd">:param name: name of circle</span>
<span class="sd">:param pc: name of the center point</span>
<span class="sd">:param p2: name of the second point that the circle passes through&quot;&quot;&quot;</span>            <span class="c1"># circle_2P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irL</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;circle_2P&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">pc</span><span class="p">,</span> <span class="n">p2</span><span class="p">],</span> <span class="n">props</span><span class="p">,</span> <span class="p">[]]</span>                      <span class="c1"># circle_2P</span></div>
<div class="viewcode-block" id="circle_2P.dependsOn"><a class="viewcode-back" href="../../p5.html#k1lib.p5.circle_2P.dependsOn">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># circle_2P</span>
    <span class="k">def</span> <span class="nf">dependsOn</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="k">return</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>                    <span class="c1"># circle_2P</span></div>
<div class="viewcode-block" id="circle_2P.calc"><a class="viewcode-back" href="../../p5.html#k1lib.p5.circle_2P.calc">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># circle_2P</span>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> <span class="n">pc</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span> <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">pc</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">p2</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">x2</span><span class="o">-</span><span class="n">xc</span><span class="p">;</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">y2</span><span class="o">-</span><span class="n">yc</span><span class="p">;</span> <span class="k">return</span> <span class="p">[</span><span class="n">xc</span><span class="p">,</span><span class="n">yc</span><span class="p">,</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">*</span><span class="n">dx</span><span class="o">+</span><span class="n">dy</span><span class="o">*</span><span class="n">dy</span><span class="p">)]</span> <span class="c1"># circle_2P</span></div></div>
<div class="viewcode-block" id="grid"><a class="viewcode-back" href="../../p5.html#k1lib.p5.grid">[docs]</a><span class="k">class</span> <span class="nc">grid</span><span class="p">(</span><span class="n">Entity</span><span class="p">):</span>                                                              <span class="c1"># grid</span>
<div class="viewcode-block" id="grid.__init__"><a class="viewcode-back" href="../../p5.html#k1lib.p5.grid.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;grid-0&quot;</span><span class="p">,</span> <span class="n">props</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>                               <span class="c1"># grid</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a grid to the plot. See also: :class:`Entity`&quot;&quot;&quot;</span>                 <span class="c1"># grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irL</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;grid-0&quot;</span><span class="p">,</span> <span class="s2">&quot;grid&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">props</span><span class="p">,</span> <span class="p">[]]</span>                             <span class="c1"># grid</span></div>
<div class="viewcode-block" id="grid.display"><a class="viewcode-back" href="../../p5.html#k1lib.p5.grid.display">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># grid</span>
    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>                                                    <span class="c1"># grid</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">]:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Please calculate the positions of everything and metadata first, before trying to display an IR that has a grid&quot;</span><span class="p">)</span> <span class="c1"># grid</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">];</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">];</span> <span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="p">[</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">],[</span><span class="n">cx</span><span class="p">,</span><span class="n">cy</span><span class="p">],[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">7</span><span class="p">];</span> <span class="n">f</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># grid</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">)</span><span class="o">/</span><span class="mf">1.3</span><span class="p">));</span> <span class="n">fac</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">scale</span> <span class="c1"># 10^scale for the grid&#39;s spacing # grid</span>
        <span class="n">ccx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">w</span><span class="o">/</span><span class="n">h</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">dy</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span> <span class="n">ccy</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">h</span><span class="o">/</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">dx</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># correction factors # grid</span>
        <span class="n">xticks</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">cx</span><span class="o">-</span><span class="n">ccx</span><span class="o">*</span><span class="n">dx</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span><span class="o">/</span><span class="n">fac</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">cx</span><span class="o">+</span><span class="n">ccx</span><span class="o">*</span><span class="n">dx</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span><span class="o">/</span><span class="n">fac</span><span class="p">))</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">/</span><span class="n">fac</span><span class="p">)</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">deref</span><span class="p">()</span> <span class="c1"># grid</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">cy</span><span class="o">-</span><span class="n">ccy</span><span class="o">*</span><span class="n">dy</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span><span class="o">/</span><span class="n">fac</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">cy</span><span class="o">+</span><span class="n">ccy</span><span class="o">*</span><span class="n">dy</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span><span class="o">/</span><span class="n">fac</span><span class="p">))</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">/</span><span class="n">fac</span><span class="p">)</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">deref</span><span class="p">()</span> <span class="c1"># grid</span>
        <span class="k">with</span> <span class="n">context</span><span class="p">():</span>                                                          <span class="c1"># grid</span>
            <span class="n">stroke</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>                                                          <span class="c1"># grid</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xticks</span><span class="p">:</span> <span class="n">line</span><span class="p">(</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cy</span><span class="o">-</span><span class="n">ccy</span><span class="o">*</span><span class="n">dy</span><span class="o">*</span><span class="mf">1.2</span><span class="p">),</span> <span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cy</span><span class="o">+</span><span class="n">ccy</span><span class="o">*</span><span class="n">dy</span><span class="o">*</span><span class="mf">1.2</span><span class="p">))</span>    <span class="c1"># grid</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">yticks</span><span class="p">:</span> <span class="n">line</span><span class="p">(</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">cx</span><span class="o">-</span><span class="n">ccx</span><span class="o">*</span><span class="n">dx</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">cx</span><span class="o">+</span><span class="n">ccx</span><span class="o">*</span><span class="n">dx</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>    <span class="c1"># grid</span></div></div>
<span class="k">def</span> <span class="nf">round2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span> <span class="k">else</span> <span class="n">x</span>                               <span class="c1"># round2</span>
<div class="viewcode-block" id="axes"><a class="viewcode-back" href="../../p5.html#k1lib.p5.axes">[docs]</a><span class="k">class</span> <span class="nc">axes</span><span class="p">(</span><span class="n">Entity</span><span class="p">):</span>                                                              <span class="c1"># axes</span>
<div class="viewcode-block" id="axes.__init__"><a class="viewcode-back" href="../../p5.html#k1lib.p5.axes.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;axes-0&quot;</span><span class="p">,</span> <span class="n">props</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>                               <span class="c1"># axes</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds xy axis to the plot. See also: :class:`Entity`&quot;&quot;&quot;</span>                <span class="c1"># axes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">irL</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;axes-0&quot;</span><span class="p">,</span> <span class="s2">&quot;axes&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="n">props</span><span class="p">,</span> <span class="p">[]]</span>                             <span class="c1"># axes</span></div>
<div class="viewcode-block" id="axes.display"><a class="viewcode-back" href="../../p5.html#k1lib.p5.axes.display">[docs]</a>    <span class="nd">@classmethod</span>                                                                 <span class="c1"># axes</span>
    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>                                                    <span class="c1"># axes</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">]:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Please calculate the positions of everything and metadata first, before trying to display an IR that has a grid&quot;</span><span class="p">)</span> <span class="c1"># axes</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">name</span><span class="p">];</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">];</span> <span class="n">w</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="p">[</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">],[</span><span class="n">cx</span><span class="p">,</span><span class="n">cy</span><span class="p">],[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">7</span><span class="p">];</span> <span class="n">f</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># axes</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">)</span><span class="o">/</span><span class="mf">1.3</span><span class="p">));</span> <span class="n">fac</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">scale</span> <span class="c1"># 10^scale for the grid&#39;s spacing # axes</span>
        <span class="n">ccx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">w</span><span class="o">/</span><span class="n">h</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dx</span><span class="o">/</span><span class="n">dy</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span> <span class="n">ccy</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">h</span><span class="o">/</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">dx</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># correction factors # axes</span>
        <span class="n">line</span><span class="p">(</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cy</span><span class="o">-</span><span class="n">ccy</span><span class="o">*</span><span class="n">dy</span><span class="o">*</span><span class="mf">1.2</span><span class="p">),</span> <span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cy</span><span class="o">+</span><span class="n">ccy</span><span class="o">*</span><span class="n">dy</span><span class="o">*</span><span class="mf">1.2</span><span class="p">))</span>                         <span class="c1"># axes</span>
        <span class="n">line</span><span class="p">(</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">cx</span><span class="o">-</span><span class="n">ccx</span><span class="o">*</span><span class="n">dx</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">cx</span><span class="o">+</span><span class="n">ccx</span><span class="o">*</span><span class="n">dx</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>                         <span class="c1"># axes</span>
        <span class="n">xticks</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">cx</span><span class="o">-</span><span class="n">ccx</span><span class="o">*</span><span class="n">dx</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span><span class="o">/</span><span class="n">fac</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">cx</span><span class="o">+</span><span class="n">ccx</span><span class="o">*</span><span class="n">dx</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span><span class="o">/</span><span class="n">fac</span><span class="p">))</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">/</span><span class="n">fac</span><span class="p">)</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">deref</span><span class="p">()</span> <span class="c1"># axes</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">cy</span><span class="o">-</span><span class="n">ccy</span><span class="o">*</span><span class="n">dy</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span><span class="o">/</span><span class="n">fac</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">cy</span><span class="o">+</span><span class="n">ccy</span><span class="o">*</span><span class="n">dy</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)</span><span class="o">/</span><span class="n">fac</span><span class="p">))</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">/</span><span class="n">fac</span><span class="p">)</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">filt</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">deref</span><span class="p">()</span> <span class="c1"># axes</span>
        <span class="k">with</span> <span class="n">context</span><span class="p">():</span>                                                          <span class="c1"># axes</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xticks</span><span class="p">:</span> <span class="n">text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">round2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">+</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># axes</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">yticks</span><span class="p">:</span> <span class="n">text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">round2</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># axes</span></div></div>
<span class="k">def</span> <span class="nf">vlen</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">):</span> <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dx</span><span class="o">*</span><span class="n">dx</span><span class="o">+</span><span class="n">dy</span><span class="o">*</span><span class="n">dy</span><span class="p">)</span> <span class="c1"># vector length                   # vlen</span>
<span class="n">entities</span> <span class="o">=</span> <span class="p">[</span><span class="n">point_raw</span><span class="p">,</span> <span class="n">point_sym</span><span class="p">,</span> <span class="n">point_L</span><span class="p">,</span> <span class="n">line_P</span><span class="p">,</span> <span class="n">line_2P</span><span class="p">,</span> <span class="n">line_2PL</span><span class="p">,</span> <span class="n">circle_PR</span><span class="p">,</span> <span class="n">circle_2P</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">axes</span><span class="p">];</span> <span class="n">entitiesD</span> <span class="o">=</span> <span class="n">entities</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">toDict</span><span class="p">()</span> <span class="c1"># vlen</span>
<span class="k">class</span> <span class="nc">IR</span><span class="p">:</span>                                                                        <span class="c1"># IR</span>
    <span class="nd">@staticmethod</span>                                                                <span class="c1"># IR</span>
    <span class="k">def</span> <span class="nf">dep</span><span class="p">(</span><span class="n">ir</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span> <span class="c1"># figures out the dependency graph, returns elements to calculate position of # IR</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[]);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">entitiesD</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="n">cli</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">name</span><span class="p">,</span><span class="bp">cls</span><span class="p">:</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span><span class="bp">cls</span><span class="o">.</span><span class="n">dependsOn</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">name</span><span class="p">)])</span> <span class="o">|</span> <span class="o">~</span><span class="n">cli</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)])</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">deref</span><span class="p">()</span> <span class="c1"># IR</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>                                                          <span class="c1"># IR</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">y</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                                           <span class="c1"># IR</span>
        <span class="n">freqs</span> <span class="o">=</span> <span class="n">a</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">toDict</span><span class="p">();</span> <span class="n">stack</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">a</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="n">cli</span><span class="o">.</span><span class="n">filt</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">deref</span><span class="p">())</span> <span class="c1"># IR</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>                                                    <span class="c1"># IR</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">popleft</span><span class="p">();</span> <span class="k">yield</span> <span class="n">c</span>                                         <span class="c1"># IR</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="n">c</span><span class="p">]:</span>                                                   <span class="c1"># IR</span>
                <span class="n">freqs</span><span class="p">[</span><span class="n">child</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>                                                <span class="c1"># IR</span>
                <span class="k">if</span> <span class="n">freqs</span><span class="p">[</span><span class="n">child</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>                        <span class="c1"># IR</span>
    <span class="nd">@staticmethod</span>                                                                <span class="c1"># IR</span>
    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="n">ir</span><span class="p">):</span> <span class="c1"># calculates position of every element and write results back to IR # IR</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">IR</span><span class="o">.</span><span class="n">dep</span><span class="p">(</span><span class="n">ir</span><span class="p">):</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">e</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">entitiesD</span><span class="p">[</span><span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">e</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">e</span><span class="p">)</span> <span class="c1"># IR</span>
        <span class="k">return</span> <span class="n">ir</span>                                                                <span class="c1"># IR</span>
    <span class="nd">@staticmethod</span>                                                                <span class="c1"># IR</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="n">ir</span><span class="p">):</span> <span class="k">return</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">entitiesD</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">bounds</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">toMin</span><span class="p">()</span> <span class="o">+</span> <span class="n">cli</span><span class="o">.</span><span class="n">toMax</span><span class="p">()</span> <span class="o">+</span> <span class="n">cli</span><span class="o">.</span><span class="n">toMin</span><span class="p">()</span> <span class="o">+</span> <span class="n">cli</span><span class="o">.</span><span class="n">toMax</span><span class="p">()</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">deref</span><span class="p">()</span> <span class="c1"># IR</span>
    <span class="nd">@staticmethod</span>                                                                <span class="c1"># IR</span>
    <span class="k">def</span> <span class="nf">calcMeta</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="mi">400</span><span class="p">):</span> <span class="c1"># calculates meta transformation functions     # IR</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="n">IR</span><span class="o">.</span><span class="n">bounds</span><span class="p">(</span><span class="n">ir</span><span class="p">)</span>                                                   <span class="c1"># IR</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">;</span> <span class="n">cx</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="n">cy</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">;</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">d</span><span class="o">-</span><span class="n">c</span>      <span class="c1"># IR</span>
        <span class="n">sx</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">dx</span><span class="p">;</span> <span class="n">sy</span> <span class="o">=</span> <span class="n">h</span><span class="o">/</span><span class="n">dy</span><span class="p">;</span> <span class="n">s</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">)</span><span class="o">/</span><span class="mf">1.2</span><span class="p">;</span> <span class="n">f1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="p">[(</span><span class="n">x</span><span class="o">-</span><span class="n">cx</span><span class="p">)</span><span class="o">*</span><span class="n">s</span><span class="o">+</span><span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">cy</span><span class="p">)</span><span class="o">*</span><span class="n">s</span><span class="o">+</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># IR</span>
        <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">],</span> <span class="p">[</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">],</span> <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">],</span> <span class="p">[</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">],</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">]];</span> <span class="k">return</span> <span class="n">ir</span> <span class="c1"># IR</span>
    <span class="nd">@staticmethod</span>                                                                <span class="c1"># IR</span>
    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="mi">400</span><span class="p">):</span> <span class="c1"># constructs an image of the IR                 # IR</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">]:</span> <span class="n">IR</span><span class="o">.</span><span class="n">calcMeta</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">)</span>                                   <span class="c1"># IR</span>
        <span class="c1"># draw order: circle -&gt; line -&gt; point, because transparent fills are not really a thing in this knock up version of p5 # IR</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">filt</span><span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;grid&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="n">entitiesD</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># IR</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">filt</span><span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;axes&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="n">entitiesD</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># IR</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">filt</span><span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="n">cli</span><span class="o">.</span><span class="n">sortF</span><span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()[</span><span class="mi">4</span><span class="p">][</span><span class="mi">2</span><span class="p">]):</span> <span class="n">entitiesD</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># IR</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">filt</span><span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">,</span>   <span class="mi">1</span><span class="p">):</span> <span class="n">entitiesD</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># IR</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="o">|</span> <span class="n">cli</span><span class="o">.</span><span class="n">filt</span><span class="p">(</span><span class="n">cli</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;point&quot;</span><span class="p">,</span>  <span class="mi">1</span><span class="p">):</span> <span class="n">entitiesD</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># IR</span>
    <span class="nd">@staticmethod</span>                                                                <span class="c1"># IR</span>
    <span class="k">def</span> <span class="nf">dist_2P</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span> <span class="n">o1</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">o2</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>                                             <span class="c1"># IR</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates distance between 2 objects given their names&quot;&quot;&quot;</span>            <span class="c1"># IR</span>
        <span class="n">o1</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">o1</span><span class="p">];</span> <span class="n">o2</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">o2</span><span class="p">];</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">o1</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> <span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="o">=</span> <span class="n">o2</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> <span class="k">return</span> <span class="n">vlen</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span> <span class="c1"># IR</span>
    <span class="nd">@staticmethod</span>                                                                <span class="c1"># IR</span>
    <span class="k">def</span> <span class="nf">length_L</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>                                                  <span class="c1"># IR</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the length of a specific line&quot;&quot;&quot;</span>                           <span class="c1"># IR</span>
        <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">line</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="k">return</span> <span class="n">vlen</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span>              <span class="c1"># IR</span>
    <span class="nd">@staticmethod</span>                                                                <span class="c1"># IR</span>
    <span class="k">def</span> <span class="nf">angle_2L</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span> <span class="n">l1</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">l2</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;radians&quot;</span><span class="p">:</span>                               <span class="c1"># IR</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the angle between 2 lines&quot;&quot;&quot;</span>                               <span class="c1"># IR</span>
        <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">l1</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="n">x3</span><span class="p">,</span><span class="n">y3</span><span class="p">,</span><span class="n">x4</span><span class="p">,</span><span class="n">y4</span> <span class="o">=</span> <span class="n">ir</span><span class="p">[</span><span class="s2">&quot;def&quot;</span><span class="p">][</span><span class="n">l2</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>           <span class="c1"># IR</span>
        <span class="n">dx1</span> <span class="o">=</span> <span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">;</span> <span class="n">dx2</span> <span class="o">=</span> <span class="n">x4</span><span class="o">-</span><span class="n">x3</span><span class="p">;</span> <span class="n">dy1</span> <span class="o">=</span> <span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">;</span> <span class="n">dy2</span> <span class="o">=</span> <span class="n">y4</span><span class="o">-</span><span class="n">y3</span>                       <span class="c1"># IR</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">((</span><span class="n">dx1</span><span class="o">*</span><span class="n">dx2</span><span class="o">+</span><span class="n">dy1</span><span class="o">*</span><span class="n">dy2</span><span class="p">)</span><span class="o">/</span><span class="n">vlen</span><span class="p">(</span><span class="n">dx1</span><span class="p">,</span><span class="n">dy1</span><span class="p">)</span><span class="o">/</span><span class="n">vlen</span><span class="p">(</span><span class="n">dx2</span><span class="p">,</span><span class="n">dy2</span><span class="p">))</span>          <span class="c1"># IR</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Quang Ho.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>