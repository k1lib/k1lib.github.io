

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Monkey patched classes &mdash; k1lib 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials" href="tutorials.html" />
    <link rel="prev" title="Changelogs" href="changelogs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> k1lib
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="bioinfo/index.html">k1lib.bioinfo package</a></li>
<li class="toctree-l1"><a class="reference internal" href="callbacks/index.html">k1lib.callbacks package</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data.html">k1lib.data module</a></li>
<li class="toctree-l1"><a class="reference internal" href="eqn.html">k1lib.eqn module</a></li>
<li class="toctree-l1"><a class="reference internal" href="format.html">k1lib.format module</a></li>
<li class="toctree-l1"><a class="reference internal" href="graphEqn.html">k1lib.graphEqn module</a></li>
<li class="toctree-l1"><a class="reference internal" href="imports.html">k1lib.imports module</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn.html">k1lib.nn module</a></li>
<li class="toctree-l1"><a class="reference internal" href="schedule.html">k1lib.schedule module</a></li>
<li class="toctree-l1"><a class="reference internal" href="selector.html">k1lib.selector module</a></li>
<li class="toctree-l1"><a class="reference internal" href="viz.html">k1lib.viz module</a></li>
<li class="toctree-l1"><a class="reference internal" href="website.html">k1lib.website module</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="changelogs.html">Changelogs</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Monkey patched classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">k1lib</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Monkey patched classes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/monkeyPatches.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="monkey-patched-classes">
<h1>Monkey patched classes<a class="headerlink" href="#monkey-patched-classes" title="Permalink to this headline">¶</a></h1>
<p>See also: <a class="reference internal" href="index.html#k1lib.patch" title="k1lib.patch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">k1lib.patch()</span></code></a></p>
<dl class="py class">
<dt id="torch.nn.modules.Module">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torch.nn.modules.</span></code><code class="sig-name descname"><span class="pre">Module</span></code><a class="headerlink" href="#torch.nn.modules.Module" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="torch.nn.modules.torch.nn.modules.Module.Module.importParams">
<code class="sig-prename descclassname"><span class="pre">Module.</span></code><code class="sig-name descname"><span class="pre">importParams</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.parameter.Parameter.html#torch.nn.parameter.Parameter" title="(in PyTorch vmaster (1.11.0a0+gitd1b988e ))"><span class="pre">torch.nn.parameter.Parameter</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#torch.nn.modules.torch.nn.modules.Module.Module.importParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.parameter.Parameter.html#torch.nn.parameter.Parameter" title="(in PyTorch vmaster (1.11.0a0+gitd1b988e ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.parameter.Parameter</span></code></a>/<a class="reference internal" href="#torch.Tensor" title="torch.Tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>,
update the current <a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch vmaster (1.11.0a0+gitd1b988e ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a>’s parameters with it’</p>
</dd></dl>

<dl class="py method">
<dt id="torch.nn.modules.torch.nn.modules.Module.Module.exportParams">
<code class="sig-prename descclassname"><span class="pre">Module.</span></code><code class="sig-name descname"><span class="pre">exportParams</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#torch.Tensor" title="torch.Tensor"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#torch.nn.modules.torch.nn.modules.Module.Module.exportParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the list of <a class="reference internal" href="#torch.Tensor" title="torch.Tensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> data</p>
</dd></dl>

<dl class="py method">
<dt id="torch.nn.modules.torch.nn.modules.Module.Module.paramsContext">
<code class="sig-prename descclassname"><span class="pre">Module.</span></code><code class="sig-name descname"><span class="pre">paramsContext</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">AbstractContextManager</span><a class="headerlink" href="#torch.nn.modules.torch.nn.modules.Module.Module.paramsContext" title="Permalink to this definition">¶</a></dt>
<dd><p>A nice context manager for <code class="xref py py-meth docutils literal notranslate"><span class="pre">importParams()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">exportParams()</span></code>.
Returns the old parameters on enter context.</p>
</dd></dl>

<dl class="py method">
<dt id="torch.nn.modules.torch.nn.modules.Module.Module.getParamsVector">
<code class="sig-prename descclassname"><span class="pre">Module.</span></code><code class="sig-name descname"><span class="pre">getParamsVector</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#torch.Tensor" title="torch.Tensor"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#torch.nn.modules.torch.nn.modules.Module.Module.getParamsVector" title="Permalink to this definition">¶</a></dt>
<dd><p>For each parameter, returns a normal distributed random tensor
with the same standard deviation as the original parameter</p>
</dd></dl>

<dl class="py method">
<dt id="torch.nn.modules.torch.nn.modules.Module.Module.preserveDevice">
<code class="sig-prename descclassname"><span class="pre">Module.</span></code><code class="sig-name descname"><span class="pre">preserveDevice</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">AbstractContextManager</span><a class="headerlink" href="#torch.nn.modules.torch.nn.modules.Module.Module.preserveDevice" title="Permalink to this definition">¶</a></dt>
<dd><p>Preserves the device of whatever operation is inside this. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="k">with</span> <span class="n">m</span><span class="o">.</span><span class="n">preserveDevice</span><span class="p">():</span>
    <span class="n">m</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span> <span class="c1"># moves whole model to cuda</span>
<span class="c1"># automatically moves model to cpu</span>
</pre></div>
</div>
<p>This will work even if the model has many tensors that live on 10 different devices.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="torch.Tensor">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torch.</span></code><code class="sig-name descname"><span class="pre">Tensor</span></code><a class="headerlink" href="#torch.Tensor" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="torch.torch.Tensor.Tensor.crissCross">
<code class="sig-prename descclassname"><span class="pre">Tensor.</span></code><code class="sig-name descname"><span class="pre">crissCross</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#torch.Tensor" title="torch.Tensor"><span class="pre">torch.Tensor</span></a><a class="headerlink" href="#torch.torch.Tensor.Tensor.crissCross" title="Permalink to this definition">¶</a></dt>
<dd><p>Concats multiple 1d tensors, sorts it, and get evenly-spaced values. Also
available as <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.crissCross()</span></code>. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">])</span>

<span class="c1"># returns tensor([2, 3, 6, 10, 18, 30])</span>
<span class="n">a</span><span class="o">.</span><span class="n">crissCross</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

<span class="c1"># returns tensor([ 2,  4,  8, 10, 18, 20, 30, 35])</span>
<span class="n">a</span><span class="o">.</span><span class="n">crissCross</span><span class="p">(</span><span class="o">*</span><span class="p">([</span><span class="n">b</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># 1 &quot;a&quot; and 10 &quot;b&quot;s</span>

<span class="c1"># returns tensor([ 2,  2,  3,  6, 18])</span>
<span class="n">b</span><span class="o">.</span><span class="n">crissCross</span><span class="p">(</span><span class="o">*</span><span class="p">([</span><span class="n">a</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># 1 &quot;b&quot; and 10 &quot;a&quot;s</span>
</pre></div>
</div>
<p>Note how in the second case, the length is the same as tensor b, and the contents
are pretty close to b. In the third case, it’s the opposite. Length is almost
the same as tensor a, and the contents are also pretty close to a.</p>
</dd></dl>

<dl class="py method">
<dt id="torch.torch.Tensor.Tensor.histBounds">
<code class="sig-prename descclassname"><span class="pre">Tensor.</span></code><code class="sig-name descname"><span class="pre">histBounds</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#torch.Tensor" title="torch.Tensor"><span class="pre">torch.Tensor</span></a><a class="headerlink" href="#torch.torch.Tensor.Tensor.histBounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Flattens and sorts the tensor, then get value of tensor at regular
linspace intervals. Does not guarantee bounds’ uniqueness. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tensor with lots of 2s and 5s</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
<span class="c1"># returns torch.tensor([2., 3., 5.])</span>
<span class="n">a</span><span class="o">.</span><span class="n">histBounds</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
<p>The example result essentially shows 3 bins: <span class="math notranslate nohighlight">\([2, 3)\)</span>, <span class="math notranslate nohighlight">\([3, 5)\)</span> and
<span class="math notranslate nohighlight">\([5, \infty)\)</span>. This might be useful in scaling pixels so that networks handle
it nicely. Rough idea taken from fastai.medical.imaging.</p>
</dd></dl>

<dl class="py method">
<dt id="torch.torch.Tensor.Tensor.histScaled">
<code class="sig-prename descclassname"><span class="pre">Tensor.</span></code><code class="sig-name descname"><span class="pre">histScaled</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#torch.Tensor" title="torch.Tensor"><span class="pre">torch.Tensor</span></a><a class="headerlink" href="#torch.torch.Tensor.Tensor.histScaled" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale tensor’s values so that the values are roughly spreaded out in range
<span class="math notranslate nohighlight">\([0, 1]\)</span> to ease neural networks’ pain. Rough idea taken from
fastai.medical.imaging. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># normal-distributed values</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1"># plot #1 shows a normal distribution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># plot #2 shows almost-uniform distribution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">histScaled</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">());</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Plot #1:</p>
<img alt="_images/histScaledNormal.png" src="_images/histScaledNormal.png" />
<p>Plot #2:</p>
<img alt="_images/histScaledUniform.png" src="_images/histScaledUniform.png" />
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bins</strong> – if <code class="docutils literal notranslate"><span class="pre">bounds</span></code> not specified, then will scale according to a hist
with this many bins</p></li>
<li><p><strong>bounds</strong> – if specified, then <code class="docutils literal notranslate"><span class="pre">bins</span></code> is ignored and will scale according to
this. Expected this to be a sorted tensor going from <code class="docutils literal notranslate"><span class="pre">min(self)</span></code> to
<code class="docutils literal notranslate"><span class="pre">max(self)</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="tutorials.html" class="btn btn-neutral float-right" title="Tutorials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="changelogs.html" class="btn btn-neutral float-left" title="Changelogs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Quang Ho.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>